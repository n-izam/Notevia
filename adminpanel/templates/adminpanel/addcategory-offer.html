{% extends "adminbase.html" %}

{% load static %}
<!-- for adding and edit offer same html -->

{% block title %} {% if request.resolver_match.url_name == 'addcategory_offer' %}Add category Offer {% else %} Edit category Offer{% endif %}{% endblock %}
{% block head %} 
<!-- Bootstrap CSS -->
<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
<!-- Bootstrap Datepicker CSS -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/css/bootstrap-datepicker.min.css" rel="stylesheet">
<!-- Font Awesome for icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
{% endblock %}

{% block style %}
<style>
    /* Optional: Add some padding and a card-like feel to the form */
    .add-offer-container {
        padding: 25px;
        background-color: #ffffff;
        border-radius: 8px;
        box-shadow: 0 4px 8px rgba(0,0,0,0.05);
    }
</style>
{% endblock %}

{% block content %}

<div class="container-fluid mt-4">
    <div class="add-offer-container">
        <h4 class="mb-4">{% if request.resolver_match.url_name == 'addcategory_offer' %}Add Offer {{category.name}} {% else %} Edit Offer '{{category.offer.title}}' of {{category.name}} {% endif %}</h4>
        <form action="{% if request.resolver_match.url_name == 'addcategory_offer' %} {% url 'addcategory_offer' category_id=category.id  %} {% else %} {% url 'editcategory_offer' category_id=category.id  %} {% endif %}" method="POST">
            {% csrf_token %}
            <div class="form-group">
                <label for="offerTitle">Title</label>
                <input type="text" class="form-control" name="offer_title" id="offerTitle" placeholder="e.g., Summer Sale" value="{% if request.resolver_match.url_name == 'addcategory_offer' %}{{ form.offer_title.value|default:'' }}{% else %} {{category.offer.title|default:''}} {% endif %}">
                {% if form.offer_title.errors %}
                    <p class="text-danger small">{{ form.offer_title.errors.0 }}</p>
                    {% endif %}
            </div>
            <div class="form-group">
                <label for="discountPercentage">Discount in Percentage</label>
                <div class="input-group">
                    <input type="number" class="form-control" name="discount" id="discountPercentage" placeholder="e.g., 25" value="{% if request.resolver_match.url_name == 'addcategory_offer' %}{{ form.discount.value|default:'' }}{% else %} {{category.offer.offer_percent|default:''}} {% endif %}">
                    <div class="input-group-append">
                        <span class="input-group-text">%</span>
                    </div>
                </div>
                {% if form.discount.errors %}
                    <p class="text-danger small">{{ form.discount.errors.0 }}</p>
                    {% endif %}
            </div>
            <div class="form-group">
                <label for="aboutOffer">About</label>
                <textarea class="form-control" id="aboutOffer" name="about" rows="3" placeholder="Briefly describe the offer">{% if request.resolver_match.url_name == 'addcategory_offer' %}{{ form.about.value|default:'' }}{% else %} {{category.offer.about|default:''}} {% endif %}</textarea>
            </div>
            {% if form.about.errors %}
                <p class="text-danger small">{{ form.about.errors.0 }}</p>
                {% endif %}
            <div class="form-group">
                <label for="startDate">Start Date</label>
                <div class="input-group date" data-provide="datepicker">
                    <input type="text"
                    class="form-control" 
                    name="start_date" id="startDate" 
                    placeholder="dd/mm/yyyy"
                    value="{% if request.resolver_match.url_name == 'addcategory_offer' %}{{ form.start_date.value|default:'' }}{% else %}{{ category.offer.start_date|date:'d/m/Y' }}{% endif %}">
                    <div class="input-group-append">
                        <span class="input-group-text"><i class="fas fa-calendar-alt"></i></span>
                    </div>
                </div>
                {% if form.start_date.errors %}
                <p class="text-danger small">{{ form.start_date.errors.0 }}</p>
                {% endif %}
            </div>
            <div class="form-group">
                <label for="endDate">End Date</label>
               <div class="input-group date" data-provide="datepicker">
                    <input type="text" 
                    class="form-control" 
                    name="end_date" id="endDate" 
                    placeholder="dd/mm/yyyy"
                    value="{% if request.resolver_match.url_name == 'addcategory_offer' %}{{ form.end_date.value|default:'' }}{% else %}{{ category.offer.end_date|date:'d/m/Y' }}{% endif %}">
                    <div class="input-group-append">
                        <span class="input-group-text"><i class="fas fa-calendar-alt"></i></span>
                    </div>
                </div>
                {% if form.end_date.errors %}
                <p class="text-danger small">{{ form.end_date.errors.0 }}</p>
                {% endif %}
            </div>
            <hr>
            <button type="submit" class="btn btn-primary">Add Offer</button>
            <button type="button" class="btn btn-secondary">Cancel</button>
        </form>
        {% if messages %}
        {% for message in messages %}
        <div class="alert alert-{{ message.tags }} mt-2" style="color: orangered;">{{ message }}</div>
        {% endfor %}
        {% endif %}
    </div>
</div>
{% endblock %}

{% block script %}
<!-- jQuery and Bootstrap Bundle (includes Popper) -->
<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.2/dist/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
<!-- Bootstrap Datepicker JS -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/js/bootstrap-datepicker.min.js"></script>

<!-- <script>
    $(document).ready(function(){
        // Initialize datepicker
        $('.date').datepicker({
            format: 'mm/dd/yyyy',
            autoclose: true,
            todayHighlight: true
        });
    });
</script> -->

<script>
    $(document).ready(function(){
        $('.date').datepicker({
            format: 'dd/mm/yyyy',
            autoclose: true,
            todayHighlight: true
        });
    });
</script>

{% endblock %}