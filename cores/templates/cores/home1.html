


{% extends "base1.html" %}
{% load static %}

{% block title %} Home Page {% endblock %}

{% block style %}
    <style>
    /* Keep all your existing Toast and Wishlist styles here */
    .wishlist-icons {
        position: absolute;
        top: 10px;
        right: 10px;
        font-size: 1.1rem;
        color: #d9534f;
        z-index: 10;
        background: rgba(255,255,255,0.8);
        padding: 5px;
        border-radius: 50%;
        line-height: 1;
    }

    /* TOAST STYLES (Keep existing glassy black style) */
    .toast-container { position: fixed; top: 1rem; right: 1rem; z-index: 5000; }
    @media (max-width: 576px) { .toast-container { top: auto !important; bottom: 1rem !important; right: 50% !important; transform: translateX(50%); width: 90%; } }
    .toast { backdrop-filter: blur(8px); background: rgba(17, 17, 17, 0.85) !important; color: #fff !important; border-radius: 12px !important; padding: 0.75rem 1rem; border: 1px solid rgba(255, 255, 255, 0.15) !important; box-shadow: 0 4px 25px rgba(0, 0, 0, 0.35); animation: slideFadeIn 0.5s ease-out; }
    .toast.bg-success { background: rgba(0, 255, 100, 0.15) !important; border-left: 4px solid #00ff73 !important; color: #409365 !important; }
    .toast.bg-danger { background: rgba(255, 0, 0, 0.15) !important; border-left: 4px solid #ff3b3b !important; color: #bb4141 !important; }
    .toast.bg-warning { background: rgba(255, 191, 0, 0.15) !important; border-left: 4px solid #ffd83b !important; color: #bb9c41 !important; }
    .toast.bg-info { background: rgba(0, 217, 255, 0.15) !important; border-left: 4px solid #74d4e7 !important; color: #338c9d !important; }
    @keyframes slideFadeIn { 0% { opacity: 0; transform: translateY(20px) scale(0.95); } 100% { opacity: 1; transform: translateY(0px) scale(1); } }
    </style>
{% endblock %}

{% block content %}

<div class="overflow-hidden">
    <!-- Hero Carousel -->
    <div id="heroCarousel" class="carousel slide" data-bs-ride="carousel">
        <div class="carousel-indicators">
            <button type="button" data-bs-target="#heroCarousel" data-bs-slide-to="0" class="active"></button>
            <button type="button" data-bs-target="#heroCarousel" data-bs-slide-to="1"></button>
            <button type="button" data-bs-target="#heroCarousel" data-bs-slide-to="2"></button>
        </div>
        <div class="carousel-inner">
            <div class="carousel-item active">
                <img src="https://res.cloudinary.com/dbufuuut7/image/upload/v1760105974/design-img4_labhnr.jpg" class="d-block w-100 hero-img" alt="Slide 1">
                <div class="carousel-caption text-start">
                    <h1 class="fw-bold hero-title">Write, Dream, Create</h1>
                    <p class="d-none d-sm-block">From school notes to personal sketches, find the perfect notebook for every idea</p>
                </div>
            </div>
            <div class="carousel-item">
                <img src="https://res.cloudinary.com/dbufuuut7/image/upload/v1760107765/static_3_xdaifv.jpg" class="d-block w-100 hero-img" alt="Slide 2">
                <div class="carousel-caption text-start">
                    <h1 class="fw-bold">Your Story Starts Here</h1>
                    <p class="d-none d-sm-block">Premium quality stationery for the modern creator.</p>
                </div>
            </div>
            <div class="carousel-item">
                <img src="https://i.pinimg.com/1200x/4a/f3/b7/4af3b7324d2f313d999a013df3ce6a75.jpg" class="d-block w-100 hero-img" alt="Slide 3">
                <div class="carousel-caption text-start">
                    <h1 class="fw-bold">Artisan Notebooks</h1>
                    <p class="d-none d-sm-block">Crafted for thinkers, designers, and dreamers.</p>
                </div>
            </div>
            <!-- ... Other Slides ... -->
        </div>
    </div>

    <!-- Shop by Category (The Responsive Fix) -->
    <div class="container my-4 my-md-5 py-3 py-md-5">
        <div class="text-center mb-4">
            <h2 class="fw-bold section-title">SHOP BY CATEGORIES</h2>
        </div>

        <div id="categoryCarousel" class="carousel slide" data-bs-ride="carousel">
            <div class="carousel-inner px-1 px-md-5">
                {% for category in categories %}
                    {% if forloop.first %}
                    <div class="carousel-item active">
                        <div class="row g-2 g-md-3">
                    {% elif forloop.counter0|divisibleby:3 %}
                    </div>
                    </div>
                    <div class="carousel-item">
                        <div class="row g-2 g-md-3">
                    {% endif %}
        
                    <div class="col-4">
                        <div class="category-card shadow-sm border-0 rounded-3">
                            {% if category.image %}
                                <div class="category-img-wrapper">
                                    <img src="{{ category.image.url }}" class="img-fluid" alt="{{ category.name }}">
                                </div>
                            {% endif %}
                            <a href="#" class="btn btn-light category-btn text-truncate px-1 px-md-3">
                                {{ category.name|upper }}
                            </a>
                        </div>
                    </div>
        
                    {% if forloop.last %}
                        </div>
                    </div>
                    {% endif %}
                {% endfor %}
            </div>
            
            <!-- Controls visible only on larger screens to keep mobile clean, though swiping works on both -->
            <button class="carousel-control-prev d-none d-md-flex" type="button" data-bs-target="#categoryCarousel" data-bs-slide="prev">
                <span class="carousel-control-prev-icon bg-dark rounded-circle"></span>
            </button>
            <button class="carousel-control-next d-none d-md-flex" type="button" data-bs-target="#categoryCarousel" data-bs-slide="next">
                <span class="carousel-control-next-icon bg-dark rounded-circle"></span>
            </button>
        </div>
    </div>

    <!-- Best Sellers -->
    <div class="container my-5 py-2">
        <div class="text-center mb-4 mb-md-5">
            <h2 class="fw-bold section-title">Best Seller</h2>
            <p class="text-muted small">Shop the latest styles: Stay ahead of the curve</p>
        </div>
        <div class="row g-3 g-md-4">
            {% for item in product_with_image %}
            <div class="col-6 col-md-4 col-lg-3">
                <div class="card h-100 border-0 product-card shadow-sm">
                    <div class="gram-image-wrapper position-relative overflow-hidden rounded-3">
                        <a href="{% url 'shop_productdetail' item.product.id %}">
                            <img src="{{item.main_image.image.url}}" class="card-img-top" alt="{{item.product.name}}">
                        </a>
                        {% if item.product.id in wishlist_products %}
                        <a href="{% url 'remove_from_wishlist' %}?product_id={{item.product.id}}" class="wishlist-icons shadow-sm"><i class="fas fa-heart text-danger"></i></a>
                        {% else %}
                        <a href="{% url 'add_to_wishlist' %}?product_id={{item.product.id}}" class="wishlist-icons shadow-sm"><i class="far fa-heart"></i></a>
                        {% endif %}
                    </div>
                    <div class="card-body px-2 text-center">
                        <h6 class="card-title mb-1 text-truncate small fw-bold">{{item.product.name}}</h6>
                        <p class="small text-muted mb-1">{{ item.product.category.name }}</p>
                        <p class="fw-bold mb-0">Rs. {{item.product.base_price}}</p>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
        <div class="text-center mt-5">
            <a href="{% url 'shop_products' %}" class="btn btn-dark px-4 rounded-pill">Show more</a>
        </div>
    </div>

    <!-- Shop Gram Mosaic -->
    <div class="container my-5 py-5">
        <div class="text-center mb-5">
            <h2 class="fw-bold section-title">Shop Gram</h2>
            <p class="text-muted small">Every idea deserves a beautiful home.</p>
        </div>
        <div class="row g-2 g-md-3">
            <div class="col-6 col-md-4"><div class="gram-image-wrapper rounded-3"><img src="https://res.cloudinary.com/dbufuuut7/image/upload/v1760124270/design-img_ft7gzd.jpg" class="img-fluid"></div></div>
            <div class="col-6 col-md-4"><div class="gram-image-wrapper rounded-3"><img src="https://res.cloudinary.com/dbufuuut7/image/upload/v1760124270/design-img5_vqukqh.jpg" class="img-fluid"></div></div>
            <div class="col-6 col-md-4"><div class="gram-image-wrapper rounded-3"><img src="https://res.cloudinary.com/dbufuuut7/image/upload/v1760124270/design-img6_n52pty.jpg" class="img-fluid"></div></div>
            <div class="col-6 col-md-6"><div class="gram-image-wrapper rounded-3"><img src="https://res.cloudinary.com/dbufuuut7/image/upload/v1760124270/design-img7_la9hmx.jpg" class="img-fluid"></div></div>
            <div class="col-12 col-md-6"><div class="gram-image-wrapper rounded-3"><img src="https://res.cloudinary.com/dbufuuut7/image/upload/v1760124270/design-img3_qbqhhz.jpg" class="img-fluid"></div></div>
        </div>
    </div>
</div>

<div class="toast-container">
    <!-- Keep your existing Django Message Toast Loop here -->
    {% if messages %}
    {% for message in messages %}
        <div class="toast align-items-center border-0 mb-2
            {% if message.tags == 'error' %} bg-danger
            {% elif message.tags == 'success' %} bg-success 
            {% elif message.tags == 'warning' %} bg-warning 
            {% else %} bg-info
            {% endif %}
        ">
            <div class="d-flex">
                <div class="toast-body">
                {% if message.tags == 'error' %}<i class="bi bi-x-circle-fill me-2"></i>
                {% elif message.tags == 'success' %}<i class="bi bi-check-circle-fill me-2"></i>
                {% elif message.tags == 'warning' %}<i class="bi bi-exclamation-triangle-fill me-2"></i>{% endif %}
                    {{ message }}
                </div>
                <button type="button" class="btn-close btn-close-muted me-2 m-auto" data-bs-dismiss="toast"></button>
            </div>
        </div>
    {% endfor %}
{% endif %}
</div>
{% endblock %}

{% block script %}
<script>
    //document.addEventListener('DOMContentLoaded', () => {
    //    document.querySelectorAll('.toast').forEach(el => {
    //        new bootstrap.Toast(el, { autohide: true, delay: 5000 }).show();
    //    });
    //});

    document.addEventListener('DOMContentLoaded', () => {
        document.querySelectorAll('.toast').forEach(el => {
            new bootstrap.Toast(el).show();
        });
    });
</script>
{% endblock %}