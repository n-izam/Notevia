{% extends "static_base.html" %}

{% load static %}
{% load socialaccount %}

{% block title %} Home Page {% endblock %}
{% block head %}
<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Expires" content="0"> 
{% endblock %}

{% block style %}

<style>

    body{
        background-color: #f9f9f9;
    }
    .main-cont {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
        margin: 0;
         /* A light grey background to see the form container */
    }

    .signup-container {
      width: 100%;
      max-width: 400px;
    }
    .btn-black {
      background-color: #000;
      color: #fff;
    }
    .btn-black:hover {
      background-color: #333;
      color: #fff;
    }
    .google-btn {
      border: 1px solid #ddd;
      background-color: #fff;
    }

    /* Default: Desktop â€” top right */
    .toast-container {
      position: fixed;
      top: 1rem;
      right: 1rem;
      z-index: 5000;
      max-width: 350px;
    }

    /* Mobile responsiveness */
    @media (max-width: 576px) {
      .toast-container {
          top: auto !important;
          bottom: 1rem !important;
          right: 50% !important;
          transform: translateX(50%);
          width: 90% !important;
          max-width: none !important;
      }
      .toast {
          width: 100% !important;
          border-radius: 8px !important;
      }
      .toast-body {
          font-size: 0.95rem;
      }
    }

    /* toste message design */
    .toast {
      background-color: #111 !important;
      color: #fff !important;
      border: 1px solid #fff !important;
      opacity: 0.95;
    }
    
    .toast.bg-success { color: rgba(54, 141, 102, 0.844) !important; background-color: rgba(119, 229, 187, 0.736) !important; }
    .toast.bg-danger  { color: #f00 !important; background-color: #0000006d !important; }
    .toast.bg-warning { color: rgb(165, 129, 46) !important; background-color: #f2aa5dd1 !important; }
    .toast.bg-info    { color: #0ff !important; }
  </style>

{% endblock %}

{% block content %}

<div class="main-cont">
    <div class="signup-container text-center">
        <h3 class="mb-4 fw-bold">Log in</h3>
        
        <form action="{% url 'signin'  %}" method="POST" novalidate>
          {% csrf_token %}
          <div class="mb-3 text-start">
            <label class="form-label">Email</label>
            <input type="email" name="email" class="form-control" placeholder="Email" value="{% if form.email.errors %} {{ form.email.value }} {% endif %}">
            {% if form.email.errors %}
            <p class="text-danger small">{{ form.email.errors.0 }}</p>
            {% endif %}
          </div>
          
          <div class="mb-3 text-start">
            <label class="form-label">Password</label>
            <div class="input-group">
              <input type="password" class="form-control" name="password" placeholder="Password.">
              <!-- <span class="input-group-text"><i class="bi bi-eye"></i></span> -->
            </div>
            {% if form.password.errors %}
            <p class="text-danger small">{{ form.password.errors.0 }}</p>
            {% endif %}
          </div>
    
          
          <p class="small text-end">
            <a class="text-decoration-none" href="{% url 'forgot_pass' %}">Forgot Password?</a>
          </p>
        
          
          <button type="submit" class="btn btn-black w-100 mb-3">Log in</button>
    
          <div class="d-flex align-items-center mb-3">
            <hr class="flex-grow-1">
            <span class="px-2 text-muted">Or Register with</span>
            <hr class="flex-grow-1">
          </div>
    
          <a type="button" href="{% provider_login_url 'google' %}" class="btn google-btn w-100">
            <img src="https://www.svgrepo.com/show/355037/google.svg" alt="Google" width="20" class="me-2">
            Google
          </a>
          <p class="small">
            Create an account <a href="{% url 'signup' %}">Sign up</a>
          </p>
        </form>
          <!-- Toast container (fixed position) -->
          <div class="toast-container">
            {% if messages %}
                {% for message in messages %}
                    <div class="toast align-items-center text-white border-0 mb-2
                        {% if message.tags == 'error' %} bg-danger
                        {% elif message.tags == 'success' %} bg-success
                        {% elif message.tags == 'warning' %} bg-warning text-dark
                        {% else %} bg-info text-dark
                        {% endif %}
                    ">
                        <div class="d-flex">
                            <div class="toast-body">
                                {{ message }}
                            </div>
                            <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast"></button>
                        </div>
                    </div>
                {% endfor %}
            {% endif %}
        </div>
      </div>
</div>

{% endblock %}

{% block script %}

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
<script>

  //document.addEventListener('DOMContentLoaded', function () {
    //var toastElList = [].slice.call(document.querySelectorAll('.toast'));
    //toastElList.map(function (toastEl) {
        //var t = new bootstrap.Toast(toastEl);
        //t.show();
    //});
//});

  document.addEventListener('DOMContentLoaded', () => {
      document.querySelectorAll('.toast').forEach(el => {
          new bootstrap.Toast(el).show();
      });
  });

  
</script>

{% endblock %}